<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OpenConstruction · Tools</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    :root{
      --oc-bg:#fff; --oc-text:#1e2a36; --oc-sub:#6b7b8c; --oc-border:#e7edf3;
      --oc-ink:#0f2e4b; --oc-link:#0b66c3; --oc-card:#fff; --oc-shadow:0 8px 24px rgba(15,46,75,.06);
      --oc-radius:14px; --oc-accent:#f2a238;
    }
    html,body{background:var(--oc-bg); color:var(--oc-text)}
    a{color:var(--oc-link)}

    .oc-container{ max-width:1080px; }

    /* Navbar */
    .oc-nav{backdrop-filter:saturate(120%) blur(6px)}
	.brand-wordmark{
	  display:flex;
	  flex-direction:column;
	  line-height:1;
	  gap:0;
	  align-items:flex-start;
	  color:#0F2E4B;
	}
	.brand-wordmark .oc-open{
	  font-size:0.75rem;
	  font-weight:400;
	  letter-spacing:0.15em;
	  text-transform:uppercase;
	  opacity:0.7;
	  margin-bottom:-0.1rem;
	}
	.brand-wordmark .oc-sep{display:none}
	.brand-wordmark .oc-construction{
	  font-size:1.35rem;
	  font-weight:700;
	  letter-spacing:-0.01em;
	}
    .oc-logo{height:44px;width:44px}
    .navbar .nav-link.plain{font-weight:700;color:var(--oc-text);padding:.5rem .6rem}
    .navbar .nav-link.plain:hover,.navbar .nav-link.plain.active{color:#0f2e4b;text-decoration:underline;text-underline-offset:3px}
    .nav-link.icon-only{line-height:1; padding-top:.375rem; padding-bottom:.375rem;}
    .nav-link.icon-only svg{display:block; width:20px; height:20px; opacity:.9}
    .nav-link.icon-only:hover svg{opacity:1}
    .btn-subscribe-icon{background:transparent;border:0;padding:.25rem .4rem;line-height:1}
    .btn-subscribe-icon svg{fill:var(--oc-accent)}
    .btn-subscribe-icon:hover svg{filter:brightness(1.15)}

    /* Highlight */
    .hl{background:linear-gradient(180deg, transparent 60%, rgba(242,162,56,.25) 0); padding:0 .06em; font-weight:700;}

    /* Hero */
    header.hero{border-bottom:1px solid var(--oc-border); background:#fff;}
    header.hero .content{padding:56px 0 28px; text-align:center}
    header.hero h1{font-weight:800; color:#0f2e4b; margin-bottom:.3rem}
    header.hero p{color:var(--oc-sub); margin:0 auto; max-width:72ch}

    /* Filter chips (selective boxes like dataset/models) */
    .filters-wrap{border-bottom:1px solid var(--oc-border); background:#fff}
    .filters{ padding:12px 0; display:flex; flex-wrap:wrap; gap:8px 10px; align-items:center }
    .chip {
      --pad-x: 14px; --pad-y: 7px;
      border:1px solid var(--oc-border);
      border-radius:999px;
      padding:var(--pad-y) var(--pad-x);
      font-weight:600; font-size:.92rem; color:#0f2e4b; background:#fff;
      box-shadow:0 1px 2px rgba(15,46,75,.04);
      user-select:none; cursor:pointer;
    }
    .chip:hover{ background:#f7fafc }
    .chip.active{
      background:#0d6efd; color:#fff; border-color:#0d6efd;
      box-shadow:0 2px 8px rgba(13,110,253,.25);
    }
    .chip .count{ opacity:.85; font-weight:600; margin-left:.3rem; }
    .filters-note{ font-size:.85rem; color:var(--oc-sub); margin-left:auto }

    /* Sections */
    .oc-section{ margin-top:24px }
    .tools-card{ background:var(--oc-card); border:1px solid var(--oc-border); border-radius:var(--oc-radius); box-shadow:var(--oc-shadow); }
    .tools-card .card-body{ padding:1.25rem 1.25rem }
    .kicker{ font-size:.82rem; letter-spacing:.18em; text-transform:uppercase; color:var(--oc-sub); margin-bottom:.25rem }
    .title{ font-weight:800; color:#0f2e4b; margin-bottom:.2rem }
    .subtitle{ color:#6b7b8c; margin-bottom:.9rem }
    .tool-block + .tool-block{ margin-top:1rem; padding-top:1rem; border-top:1px dashed var(--oc-border); }
    .tool-name{ font-weight:700; color:#0f2e4b; margin-bottom:.15rem }
    .tool-summary{ color:#2a3946; margin-bottom:.35rem }
    .links a{ margin-right:.75rem }
    .small-muted{ color:var(--oc-sub) }

    /* Floating submit */
    .issue-btn{ position:fixed;bottom:20px;right:20px;z-index:1050;background:#0d6efd;color:#fff;padding:12px 20px;border-radius:999px;font-weight:600;font-size:.9rem;box-shadow:0 4px 12px rgba(0,0,0,.25);text-decoration:none;transition:background .2s,transform .2s }
    .issue-btn:hover{ background:#0b5ed7; transform:translateY(-2px); color:#fff; text-decoration:none }
  </style>
</head>
<body>

<!-- NAV -->
<nav class="navbar navbar-expand-lg bg-white border-bottom sticky-top oc-nav">
  <div class="container oc-container">
    <a class="navbar-brand d-flex align-items-center gap-2" href="index.html">
      <img src="assets/img/icon.png" alt="OpenConstruction logo" class="oc-logo" height="44" width="44">
      <span class="brand-wordmark"><span class="oc-open">Open</span><span class="oc-sep">·</span><span class="oc-construction">Construction</span></span>
    </a>
    <button class="navbar-toggler ms-2" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExample" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarsExample">
      <ul class="navbar-nav ms-auto align-items-lg-center gap-2">
        <li class="nav-item"><a class="nav-link plain" href="index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link plain" href="dataset.html">Datasets</a></li>
        <li class="nav-item"><a class="nav-link plain" href="models.html">Models</a></li>
        <li class="nav-item"><a class="nav-link plain" href="deployments.html">Use Cases</a></li>
        <li class="nav-item dropdown">
          <a class="nav-link plain dropdown-toggle active" href="#" id="ddResources" role="button" data-bs-toggle="dropdown" aria-expanded="false">Resources</a>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="ddResources">
            <li><a class="dropdown-item active" href="tools.html">Tools</a></li>
            <li><a class="dropdown-item" href="guides.html">Guides</a></li>
			<li><a class="dropdown-item" href="mcp.html">MCP Docs</a></li>
          </ul>
        </li>
        <li class="nav-item"><a class="nav-link plain" href="contributors.html">Community</a></li>
        <!-- GitHub -->
        <li class="nav-item">
          <a class="nav-link px-2 icon-only" href="https://github.com/ruoxinx/OpenConstruction-Datasets" target="_blank" rel="noopener" aria-label="OpenConstruction on GitHub" title="View on GitHub">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true"><path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52 0-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.59-.17 1.22-.27 2-.27s1.41.1 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.19 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8"></path></svg>
          </a>
        </li>
        <!-- Subscribe -->
        <li class="nav-item">
          <button type="button" class="nav-link px-2 icon-only btn-subscribe-icon" data-bs-toggle="modal" data-bs-target="#subscribeModal" aria-label="Subscribe for updates" title="Subscribe">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                 viewBox="0 0 16 16" aria-hidden="true" class="icon-bell">
              <path d="M8 16a2 2 0 0 0 1.985-1.75H6.015A2 2 0 0 0 8 16zm.5-14a.5.5 0 0 0-1 0
                       7 7 0 0 0-5.468 6.37c-.084.58-.272 1.204-.653 1.856-.356.617-.879 1.104-1.379 1.357V13h14v-1.417
                       c-.5-.253-1.023-.74-1.379-1.357-.38-.652-.569-1.276-.653-1.856A7 7 0 0 0 8.5 2z"/>
            </svg>
          </button>
        </li>
      </ul>
    </div>
  </div>
</nav>

<header class="hero">
  <div class="container oc-container content">
    <h1>Tools &amp; Infrastructure</h1>
    <p class="lead">A curated collection of <span class="hl">open-source tools</span> for <span class="hl">data annotation</span>, <span class="hl">versioning</span>, <span class="hl">management</span>.</p>
  </div>
</header>

<!-- Selective boxes (chips) -->
<div class="filters-wrap">
  <div class="container oc-container">
    <div class="filters" id="filters" role="group" aria-label="Filter tools by category">
      <!-- Chips injected from JSON -->
      <span id="filtersNote" class="filters-note"></span>
    </div>
  </div>
</div>

<main class="container oc-container my-4" id="tools-root"></main>

<!-- Floating submit -->
<a href="https://github.com/ruoxinx/OpenConstruction-Datasets/issues/new?template=new_tool.yml"
   class="issue-btn" target="_blank" rel="noopener">Add New Tool</a>

<footer class="py-4 mt-3 border-top">
  <div class="container oc-container small text-muted text-center">
    <div>
      © <span id="yearNow"></span> OpenConstruction
    </div>
    <div class="mt-2">
      <small>
        <strong>Disclaimer:</strong> OpenConstruction indexes publicly accessible research metadata and provides 
        links to original sources. We do not host or distribute datasets, models, code, or paywalled content. 
        All rights remain with the original authors, creators, and publishers.
      </small>
    </div>
  </div>
</footer>


<script>document.getElementById('yearNow').textContent=new Date().getFullYear();</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Subscribe Modal -->
<div class="modal fade" id="subscribeModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered" style="max-width:420px;">
    <div class="modal-content p-3 rounded-3 shadow">
      <div class="d-flex align-items-center justify-content-between mb-2">
        <h6 class="m-0 fw-semibold">Subscribe</h6>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <form action="https://github.us5.list-manage.com/subscribe/post?u=12fa0b9a59e8110ba3a89fc76&amp;id=696e3eb0b3&amp;f_id=006fbeedf0"
            method="post" target="_blank" novalidate>
        <label for="sub-email" class="form-label small text-muted mb-1">Email</label>
        <input type="email" id="sub-email" name="EMAIL" class="form-control mb-2" placeholder="you@university.edu" required>
        <button type="submit" class="btn btn-primary w-100 mt-2">Subscribe</button>
        <div style="position:absolute; left:-5000px" aria-hidden="true"><input type="text" name="b_12fa0b9a59e8110ba3a89fc76_696e3eb0b3" tabindex="-1" value=""></div>
        <p class="small text-muted mt-2 mb-0">We’ll email only when new datasets or models are added. Unsubscribe anytime.</p>
      </form>
    </div>
  </div>
</div>

<script>
(() => {
  const root = document.getElementById('tools-root');
  const filtersEl = document.getElementById('filters');
  const filtersNote = document.getElementById('filtersNote');

  const link = (label, url) => url ? `<a href="${url}" target="_blank" rel="noopener">${label}</a>` : '';

  const toolBlock = (t) => `
    <div class="tool-block">
      <div class="d-flex justify-content-between align-items-start flex-wrap gap-2">
        <div class="tool-name"><a href="${t.url}" target="_blank" rel="noopener">${t.name}</a></div>
        <div class="links small-muted">
          ${t.docs ? link('Docs', t.docs) : ''}${t.docs && t.repo ? ' · ' : ''}${t.repo ? link('Repo', t.repo) : ''}
        </div>
      </div>
      <p class="tool-summary">${t.summary||''}</p>
      ${Array.isArray(t.details) && t.details.length ? `<ul class="mb-0">${t.details.map(d=>`<li class="small-muted">${d}</li>`).join('')}</ul>` : ''}
    </div>`;

  const sectionCard = (s) => `
    <section class="oc-section" data-cat="${slugify(s.title)}" data-toolcount="${(s.items||[]).length}">
      <div class="tools-card">
        <div class="card-body">
          ${s.kicker ? `<div class="kicker">${s.kicker}</div>` : ''}
          <h3 class="title">${s.title||''}</h3>
          ${s.subtitle ? `<div class="subtitle">${s.subtitle}</div>` : ''}
          ${(s.items||[]).map(toolBlock).join('')}
        </div>
      </div>
    </section>`;

  function slugify(str){ return (str||'').toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,''); }

  function buildChips(sections){
    // "All" chip first
    const totalTools = sections.reduce((acc,s)=>acc+(s.items?.length||0),0);
    const allChip = document.createElement('button');
    allChip.type = 'button';
    allChip.className = 'chip active';
    allChip.dataset.value = '__all__';
    allChip.setAttribute('aria-pressed','true');
    allChip.textContent = 'All';
    const cnt = document.createElement('span'); cnt.className='count'; cnt.textContent = totalTools;
    allChip.appendChild(cnt);
    filtersEl.insertBefore(allChip, filtersNote);

    // Section chips
    sections.forEach(s => {
      const chip = document.createElement('button');
      chip.type = 'button';
      chip.className = 'chip';
      chip.dataset.value = slugify(s.title);
      chip.setAttribute('aria-pressed','false');
      chip.innerHTML = `${s.title}<span class="count">${s.items?.length||0}</span>`;
      filtersEl.insertBefore(chip, filtersNote);
    });
  }

  function renderAll(sections){
    root.innerHTML = sections.map(sectionCard).join('');
  }

	function applyFilter(selected){
	  const sections = Array.from(root.querySelectorAll('.oc-section'));
	  let shownTools = 0;

	  if (selected.size === 0 || selected.has('__all__')) {
		sections.forEach(sec => {
		  sec.style.display = '';
		  shownTools += Number(sec.dataset.toolcount || 0);
		});
		// Show ONLY the number of tools (remove section count)
		filtersNote.textContent = `${shownTools} tool${shownTools !== 1 ? 's' : ''}`;
		return;
	  }

  sections.forEach(sec => {
    const match = selected.has(sec.dataset.cat);
    sec.style.display = match ? '' : 'none';
    if (match) shownTools += Number(sec.dataset.toolcount || 0);
  });

  // Show ONLY the number of tools (remove section count)
  filtersNote.textContent = `${shownTools} tool${shownTools !== 1 ? 's' : ''}`;
}

  function syncFromHash(){
    const m = location.hash.match(/cats=([^&]+)/i);
    const set = new Set();
    if(m){
      decodeURIComponent(m[1]).split(',').forEach(slug => { if(slug) set.add(slug); });
    }
    // update chip UI
    const chips = filtersEl.querySelectorAll('.chip');
    chips.forEach(ch => {
      const v = ch.dataset.value;
      const active = (set.size===0 && v==='__all__') || (set.size>0 && set.has(v));
      ch.classList.toggle('active', active);
      ch.setAttribute('aria-pressed', active ? 'true':'false');
    });
    return set;
  }

  function syncToHash(selected){
    const u = new URL(location);
    if(selected.size===0 || selected.has('__all__')){ u.hash=''; }
    else{ u.hash = 'cats=' + encodeURIComponent(Array.from(selected).join(',')); }
    history.replaceState(null,'',u);
  }

  function wireChips(){
    filtersEl.addEventListener('click', (e)=>{
      const chip = e.target.closest('.chip');
      if(!chip) return;

      const value = chip.dataset.value;
      const chips = Array.from(filtersEl.querySelectorAll('.chip'));
      const selected = new Set(
        chips.filter(c => c.classList.contains('active')).map(c=>c.dataset.value)
      );

      if(value==='__all__'){
        // Turn All on, others off
        chips.forEach(c => {
          const active = (c.dataset.value==='__all__');
          c.classList.toggle('active', active);
          c.setAttribute('aria-pressed', active ? 'true':'false');
        });
        applyFilter(new Set(['__all__']));
        syncToHash(new Set(['__all__']));
        return;
      }

      // Toggle this category
      const willActivate = !chip.classList.contains('active');
      if(willActivate) selected.add(value); else selected.delete(value);
      // remove __all__ if any specific selected
      selected.delete('__all__');

      // If nothing selected, fall back to ALL
      if(selected.size===0) selected.add('__all__');

      // Update chip visuals
      chips.forEach(c => {
        const v = c.dataset.value;
        const active = selected.has('__all__') ? (v==='__all__') : selected.has(v);
        c.classList.toggle('active', active);
        c.setAttribute('aria-pressed', active ? 'true':'false');
      });

      applyFilter(selected);
      syncToHash(selected);
    });
  }

  // Init
  fetch('data/tools.json',{cache:'no-store'})
    .then(r => { if(!r.ok) throw new Error('Failed to load tools.json'); return r.json(); })
    .then(data => {
      const sections = data?.sections || [];
      buildChips(sections);
      renderAll(sections);
      wireChips();
      // Start from hash (deep-link)
      const selected = syncFromHash();
      applyFilter(selected);
    })
    .catch(() => { root.innerHTML = `<div class="alert alert-danger">Couldn’t load tools. Please check <code>assets/data/tools.json</code>.</div>`; });
})();
</script>
</body>
</html>
