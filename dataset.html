<!DOCTYPE html> 
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OpenConstruction</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    /* ---------- Design tokens (LIGHT ONLY) ---------- */
    :root{
      --oc-bg:#fff; --oc-text:#1e2a36; --oc-sub:#6b7b8c;
      --oc-border:#e7edf3; --oc-ink:#0f2e4b; --oc-link:#0b66c3;
      --oc-card:#fff; --oc-shadow:0 8px 24px rgba(15,46,75,.06);
      --oc-radius:14px; --oc-muted:#f6f9fc;
      --oc-brand:#0f2e4b; --oc-accent:#f2a238;
    }
    html,body{background:var(--oc-bg); color:var(--oc-text)}
    a{color:var(--oc-link)}

    /* ---------- Navbar ---------- */
    .oc-nav{backdrop-filter:saturate(120%) blur(6px)}
    .brand-wordmark{display:inline-flex;gap:.25rem;align-items:baseline;color:#0F2E4B;font-weight:700;letter-spacing:.1px;font-size:clamp(1.1rem,1.1rem + .4vw,1.35rem)}
    .brand-wordmark .oc-open{font-weight:600;opacity:.95}
    .brand-wordmark .oc-sep{opacity:.35;margin:0 .15rem}
    .brand-wordmark .oc-construction{font-weight:800;letter-spacing:.15px}
    .oc-logo{height:44px;width:44px}

    .navbar .nav-link.plain{
      font-weight:700;
      color:var(--oc-text);
      padding:.5rem .6rem;
    }
    .navbar .nav-link.plain:hover{
      color:var(--oc-ink);
      text-decoration:underline;
      text-underline-offset:3px;
    }
    .navbar .nav-link.plain.active{
      color:var(--oc-ink);
      text-decoration:underline;
      text-underline-offset:3px;
    }

    .oc-btn{border-radius:999px;border-color:#d6dde6;color:#24384d}
    .oc-btn:hover{background:#f4f7fb;border-color:#cbd6e3;color:#0f2e4b}

    /* ---------- Added date pill ---------- */
    .added-note{
      align-self:center; color:#5f6b77; background:#eff3f6;
      border:1px solid var(--oc-border); font-weight:600;
      border-radius:999px; padding:.2rem .6rem; font-size:.78rem
    }

    /* ---------- Filters ---------- */
    .filters{ position:sticky; top:86px; }
    .facet-list{ max-height: 280px; overflow:auto; border:1px solid var(--oc-border); border-radius:.5rem; padding:.55rem; background:var(--oc-card) }
    .facet-list .form-check{ margin-bottom:.25rem }
    .card .form-label{ font-weight:700 }
    .facet-toggle{ font-size:.875rem; line-height:1.2 }

    /* ---------- Result cards ---------- */
    .dataset-card{ background:var(--oc-card); border:1px solid var(--oc-border); border-radius:var(--oc-radius); box-shadow:var(--oc-shadow); height:100% }
    .dataset-card .card-body{ padding:1rem 1rem }
    .dataset-card .title{ font-weight:700; color:var(--oc-ink); margin-bottom:.15rem }
    .dataset-card .meta{ font-size:.85rem; color:var(--oc-sub) }

    .badge-soft{ background:var(--oc-muted); border:1px solid var(--oc-border); color:var(--oc-text); font-weight:600 }

    .empty{ border:1px dashed var(--oc-border); border-radius:12px; padding:24px; text-align:center; color:var(--oc-sub) }
    .skeleton{ position:relative; overflow:hidden; background:var(--oc-muted); border-radius:10px; min-height:120px }
    .skeleton::after{ content:""; position:absolute; inset:0; transform:translateX(-100%); background:linear-gradient(90deg,transparent,rgba(255,255,255,.5),transparent); animation:shimmer 1.1s infinite; mix-blend-mode:overlay }
    @keyframes shimmer{ to{ transform:translateX(100%) } }
  </style>
</head>
<body>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg bg-white border-bottom sticky-top oc-nav">
  <div class="container">
    <a class="navbar-brand d-flex align-items-center gap-2" href="index.html">
      <img src="assets/img/icon.png" alt="OpenConstruction logo" height="44" width="44" class="oc-logo">
      <span class="brand-wordmark"><span class="oc-open">Open</span><span class="oc-sep">·</span><span class="oc-construction">Construction</span></span>
    </a>
    <button class="navbar-toggler ms-2" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExample">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarsExample">
      <ul class="navbar-nav ms-auto align-items-lg-center gap-2">
        <li class="nav-item"><a class="nav-link plain" href="index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link plain active" href="dataset.html" aria-current="page">Datasets</a></li>
        <li class="nav-item"><a class="nav-link plain" href="models.html">Models</a></li>
        <li class="nav-item"><a class="nav-link plain" href="contributors.html">Community</a></li>
      </ul>
    </div>
  </div>
</nav>

<header class="hero border-bottom bg-white">
  <div class="container content text-center py-4">
    <h1 class="display-6 fw-bold">OpenConstruction Dataset Catalog</h1>
    <p class="lead text-muted">Explore open datasets for construction monitoring and analysis</p>
  </div>
</header>

<main class="container my-4">
  <div class="row g-3">
    <!-- Filters -->
    <aside class="col-lg-3">
      <div class="card shadow-sm filters">
        <div class="card-header"><strong>Filters</strong></div>
        <div class="card-body small">
          <div class="mb-3"><label class="form-label">Modalities</label><div id="filter-modality" class="facet-list"></div></div>
          <div class="mb-3"><label class="form-label">Tasks</label><input id="taskSearch" type="text" class="form-control form-control-sm mb-2" placeholder="Search tasks…"><div id="filter-task" class="facet-list"></div></div>
          <div class="mb-3"><label class="form-label">Licenses</label><input id="licenseSearch" type="text" class="form-control form-control-sm mb-2" placeholder="Search licenses…"><div id="filter-license" class="facet-list"></div></div>
        </div>
      </div>
    </aside>

    <!-- Results -->
    <section class="col-lg-9">
      <div class="toolbar mb-2 d-flex justify-content-between">
        <div><span id="resultCount">0</span> datasets</div>
        <select id="sortBy" class="form-select form-select-sm w-auto">
          <option value="year-desc" selected>Year ↓</option>
          <option value="year-asc">Year ↑</option>
          <option value="name-asc">Name A→Z</option>
        </select>
      </div>
      <div id="datasetGrid" class="row g-3"></div>
      <div id="emptyState" class="empty mt-3 d-none">No datasets match your filters.</div>
    </section>
  </div>
</main>

<footer class="border-top py-4 mt-5">
  <div class="container small text-muted">© <span id="yearNow"></span> OpenConstruction</div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  document.getElementById('yearNow').textContent = new Date().getFullYear();

  async function loadDatasets(){
    try {
      const resp = await fetch('datasets.json');
      const data = await resp.json();
      renderDatasets(Object.values(data));
    } catch(e){ console.error(e); }
  }

  function renderDatasets(list){
    const grid=document.getElementById('datasetGrid');
    grid.innerHTML='';
    list.forEach(d=>{
      const doiLink = d.doi ? `https://doi.org/${d.doi}` : '';
      grid.insertAdjacentHTML('beforeend',`
        <div class="col-md-6 col-xl-4">
          <div class="dataset-card h-100 d-flex flex-column">
            <div class="card-body flex-grow-1 d-flex flex-column">
              <div class="title">${d.name||'Untitled'}</div>
              <div class="meta mb-1">${(d.authors||[]).join(', ')} • ${d.year||'—'}</div>
              <p class="small flex-grow-1">${d.abstract||''}</p>
              <div class="d-flex flex-wrap align-items-center gap-2 mt-1">
                ${d.paper_url ? `<a class="btn btn-sm btn-primary" href="${d.paper_url}" target="_blank">Paper</a>`:''}
                ${d.access ? `<a class="btn btn-sm btn-outline-secondary" href="${d.access}" target="_blank">Access</a>`:''}
                ${doiLink ? `<a class="btn btn-sm btn-outline-secondary" href="${doiLink}" target="_blank">DOI</a>`:''}
                ${d.added_date ? `<span class="added-note ms-auto">Added ${d.added_date}</span>` : ''}
              </div>
            </div>
          </div>
        </div>
      `);
    });
    document.getElementById('resultCount').textContent=list.length;
  }

  loadDatasets();
</script>
</body>
</html>
